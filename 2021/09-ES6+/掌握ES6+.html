<!DOCTYPE html>
<html>

<head>
  <title>掌握ES6+中“必问”的面试题</title>
  <meta charset='utf-8'>
  <link href='https://cdn.maxiang.io/res-min/themes/marxico.css' rel='stylesheet'>
  <style>
    .note-content {
      font-family: "Helvetica Neue", Arial, "Hiragino Sans GB", STHeiti, "Microsoft YaHei", "WenQuanYi Micro Hei", SimSun, Song, sans-serif;
    }
  </style>
</head>

<body>
  <div id='preview-contents' class='note-content'>
    <h4 id="吊打面试官系列-一晚掌握es6中必问的面试题">掌握ES6+中“必问”的面试题</h4>

    <p><strong>课程大纲</strong></p>

    <ol>
      <li rel="1">
        <p>字节跳动：谈谈对Symbol的理解(不单是唯一值)</p>
      </li>
      <li rel="2">
        <p>面试必问：Generator生成器及实战中的运用</p>
      </li>
      <li rel="3">
        <p>面试必问：Iterator迭代器及Set/Map运用</p>
      </li>
      <li rel="4">
        <p>面试加分项：手撕async/await源码</p>
      </li>
      <li rel="5">
        <p>面试必问：defineProperty VS Proxy</p>
      </li>
    </ol>

    <h4 id="你不知道的symbol">你不知道的Symbol</h4>

    <blockquote>
      <p>ES6中新加入的 <strong>原始数据类型(基本数据类型/值类型)</strong>，代表唯一值</p>

      <ul>
        <li>
          <p>对象的唯一属性：防止同名属性，及被改写或覆盖</p>
        </li>
        <li>
          <p>消除魔术字符串：指代码中多次出现，强耦合的字符串或数值，应避免，而使用含义清晰的变量代替 </p>
        </li>
      </ul>
    </blockquote>

    <pre class="prettyprint hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-keyword">const</span> key = <span class="hljs-built_in">Symbol</span>(),
</div><div class="hljs-line">    key2 = <span class="hljs-built_in">Symbol</span>();
</div><div class="hljs-line"><span class="hljs-keyword">let</span> obj = {
</div><div class="hljs-line">    [key]: <span class="hljs-string">'珠峰培训'</span>
</div><div class="hljs-line">};
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(obj[key]); <span class="hljs-comment">//"珠峰培训"</span>
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(obj[key2]); <span class="hljs-comment">//undefined</span>
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line"><span class="hljs-comment">/*</span>
</div><div class="hljs-line"><span class="hljs-comment">function reducer(action) {</span>
</div><div class="hljs-line"><span class="hljs-comment">    let state = {</span>
</div><div class="hljs-line"><span class="hljs-comment">        count: 0</span>
</div><div class="hljs-line"><span class="hljs-comment">    };</span>
</div><div class="hljs-line"><span class="hljs-comment">    switch (action.type) {</span>
</div><div class="hljs-line"><span class="hljs-comment">        case "vote_plus": //魔术字符串</span>
</div><div class="hljs-line"><span class="hljs-comment">            state.count++;</span>
</div><div class="hljs-line"><span class="hljs-comment">            break;</span>
</div><div class="hljs-line"><span class="hljs-comment">    }</span>
</div><div class="hljs-line"><span class="hljs-comment">    return state;</span>
</div><div class="hljs-line"><span class="hljs-comment">}</span>
</div><div class="hljs-line"><span class="hljs-comment">reducer({</span>
</div><div class="hljs-line"><span class="hljs-comment">    type: 'vote_plus' //魔术字符串</span>
</div><div class="hljs-line"><span class="hljs-comment">}); </span>
</div><div class="hljs-line"><span class="hljs-comment">*/</span>
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line"><span class="hljs-keyword">const</span> vote_plus = <span class="hljs-built_in">Symbol</span>(<span class="hljs-string">"vote_plus"</span>);
</div><div class="hljs-line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reducer</span>(<span class="hljs-params">action</span>) </span>{
</div><div class="hljs-line">    <span class="hljs-keyword">let</span> state = {
</div><div class="hljs-line">        <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>
</div><div class="hljs-line">    };
</div><div class="hljs-line">    <span class="hljs-keyword">switch</span> (action.type) {
</div><div class="hljs-line">        <span class="hljs-keyword">case</span> vote_plus:
</div><div class="hljs-line">            state.count++;
</div><div class="hljs-line">            <span class="hljs-keyword">break</span>;
</div><div class="hljs-line">    }
</div><div class="hljs-line">    <span class="hljs-keyword">return</span> state;
</div><div class="hljs-line">}
</div><div class="hljs-line">reducer({
</div><div class="hljs-line">    <span class="hljs-attr">type</span>: vote_plus
</div><div class="hljs-line">});
</div></code></pre>

    <p><strong>基本语法</strong></p>

    <ul>
      <li>
        <p>Symbol() 和 Symbol([key])</p>
      </li>
      <li>
        <p>Symbol函数不能被new</p>
      </li>
      <li>
        <p>Symbol.prototype 与 Object(Symbol())</p>
      </li>
      <li>
        <p>Symbol不能与其他类型的值计算</p>

        <ul>
          <li>
            <p>数学计算：不能转换为数字</p>
          </li>
          <li>
            <p>字符串拼接：隐式转换不可以，但是可以显示转换</p>
          </li>
          <li>
            <p>模板字符串</p>
          </li>
        </ul>
      </li>
      <li>
        <p>Symbol 属性不参与 for…in/of 遍历</p>

        <ul>
          <li>
            <p>Object.getOwnPropertySymbols</p>
          </li>
          <li>
            <p>Object.getOwnPropertyNames</p>
          </li>
          <li>
            <p>JSON.stringify</p>
          </li>
          <li>
            <p>Object.keys</p>
          </li>
          <li>
            <p>……</p>
          </li>
        </ul>
      </li>
    </ul>

    <p><strong>内置的Symbol值</strong></p>

    <blockquote>
      <p>ES6提供很多内置的Symbol值，指向语言内部使用的方法</p>

      <ul>
        <li>
          <p>Symbol.hasInstance：对象的Symbol.hasInstance属性，指向一个内部方法，当其他对象使用instanceof运算符，判断是否为该对象的实例时，会调用这个方法</p>
        </li>
        <li>
          <p>Symbol.isConcatSpreadable：值为布尔值，表示该对象用于Array.prototype.concat()时，是否可以展开</p>
        </li>
        <li>
          <p>Symbol.iterator：拥有此属性的对象被誉为可被迭代的对象，可以使用for…of循环</p>
        </li>
        <li>
          <p>Symbol.toPrimitive: 该对象被转为原始类型的值时，会调用这个方法，返回该对象对应的原始类型值 </p>
        </li>
        <li>
          <p>Symbol.toStringTag：在该对象上面调用Object.prototype.toString方法时，如果这个属性存在，它的返回值会出现在toString方法返回的字符串之中，表示对象的类型</p>
        </li>
        <li>
          <p>……</p>
        </li>
      </ul>
    </blockquote>

    <pre class="prettyprint hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>{}
</div><div class="hljs-line"><span class="hljs-keyword">let</span> p1 = <span class="hljs-keyword">new</span> Person;
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(p1 <span class="hljs-keyword">instanceof</span> Person); <span class="hljs-comment">//true</span>
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(Person[<span class="hljs-built_in">Symbol</span>.hasInstance](p1)); <span class="hljs-comment">//true</span>
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>[<span class="hljs-built_in">Symbol</span>.hasInstance]({})); <span class="hljs-comment">//true</span>
</div></code></pre>



    <pre class="prettyprint hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>];
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(arr[<span class="hljs-built_in">Symbol</span>.isConcatSpreadable]); <span class="hljs-comment">//undefined</span>
</div><div class="hljs-line"><span class="hljs-keyword">let</span> res = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>].concat(arr);
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(res); <span class="hljs-comment">//[1,2,3,4,5,6]</span>
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line">arr[<span class="hljs-built_in">Symbol</span>.isConcatSpreadable] = <span class="hljs-literal">false</span>;
</div><div class="hljs-line">res = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>].concat(arr);
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(res); <span class="hljs-comment">//[1,2,3,[4,5,6]]</span>
</div></code></pre>



    <pre class="prettyprint hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-comment">// 让对象变为可迭代的值</span>
</div><div class="hljs-line"><span class="hljs-keyword">let</span> obj = {
</div><div class="hljs-line">    <span class="hljs-number">0</span>: <span class="hljs-string">'珠峰培训'</span>,
</div><div class="hljs-line">    <span class="hljs-number">1</span>: <span class="hljs-number">11</span>,
</div><div class="hljs-line">    <span class="hljs-attr">length</span>: <span class="hljs-number">2</span>,
</div><div class="hljs-line">    [<span class="hljs-built_in">Symbol</span>.iterator]: <span class="hljs-built_in">Array</span>.prototype[<span class="hljs-built_in">Symbol</span>.iterator]
</div><div class="hljs-line">};
</div><div class="hljs-line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> item <span class="hljs-keyword">of</span> obj) {
</div><div class="hljs-line">    <span class="hljs-built_in">console</span>.log(item);
</div><div class="hljs-line">}
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line"><span class="hljs-comment">// 构造一个类数组</span>
</div><div class="hljs-line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ArrayLike</span> </span>{
</div><div class="hljs-line">    *[<span class="hljs-built_in">Symbol</span>.iterator]() {
</div><div class="hljs-line">        <span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;
</div><div class="hljs-line">        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>[i] !== <span class="hljs-literal">undefined</span>) {
</div><div class="hljs-line">            <span class="hljs-keyword">yield</span> <span class="hljs-keyword">this</span>[i];
</div><div class="hljs-line">            ++i;
</div><div class="hljs-line">        }
</div><div class="hljs-line">    }
</div><div class="hljs-line">}
</div><div class="hljs-line"><span class="hljs-keyword">let</span> like1 = <span class="hljs-keyword">new</span> ArrayLike;
</div><div class="hljs-line">like1[<span class="hljs-number">0</span>] = <span class="hljs-number">10</span>;
</div><div class="hljs-line">like1[<span class="hljs-number">1</span>] = <span class="hljs-number">20</span>;
</div><div class="hljs-line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> item <span class="hljs-keyword">of</span> like1) {
</div><div class="hljs-line">    <span class="hljs-built_in">console</span>.log(item);
</div><div class="hljs-line">}
</div></code></pre>

    <pre class="prettyprint hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"> <span class="hljs-comment">/*</span>
</div><div class="hljs-line"><span class="hljs-comment"> * 对象数据类型进行转换：</span>
</div><div class="hljs-line"><span class="hljs-comment"> * 1. 调用obj[Symbol.toPrimitive](hint)，前提是存在</span>
</div><div class="hljs-line"><span class="hljs-comment"> * 2. 否则，如果 hint 是 "string" —— 尝试 obj.toString() 和 obj.valueOf()</span>
</div><div class="hljs-line"><span class="hljs-comment"> * 3. 否则，如果 hint 是 "number" 或 "default" —— 尝试 obj.valueOf() 和 obj.toString()</span>
</div><div class="hljs-line"><span class="hljs-comment"> */</span>
</div><div class="hljs-line"><span class="hljs-keyword">let</span> a = {
</div><div class="hljs-line">    <span class="hljs-attr">value</span>: <span class="hljs-number">0</span>,
</div><div class="hljs-line">    [<span class="hljs-built_in">Symbol</span>.toPrimitive](hint) {
</div><div class="hljs-line">        <span class="hljs-keyword">switch</span> (hint) {
</div><div class="hljs-line">            <span class="hljs-keyword">case</span> <span class="hljs-string">'number'</span>: <span class="hljs-comment">//此时需要转换成数值 例如:数学运算`</span>
</div><div class="hljs-line">                <span class="hljs-keyword">return</span> ++<span class="hljs-keyword">this</span>.value;
</div><div class="hljs-line">            <span class="hljs-keyword">case</span> <span class="hljs-string">'string'</span>: <span class="hljs-comment">// 此时需要转换成字符串 例如:字符串拼接</span>
</div><div class="hljs-line">                <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(<span class="hljs-keyword">this</span>.value);
</div><div class="hljs-line">            <span class="hljs-keyword">case</span> <span class="hljs-string">'default'</span>: <span class="hljs-comment">//此时可以转换成数值或字符串 例如：==比较</span>
</div><div class="hljs-line">                <span class="hljs-keyword">return</span> ++<span class="hljs-keyword">this</span>.value;
</div><div class="hljs-line">        }
</div><div class="hljs-line">    }
</div><div class="hljs-line">};
</div><div class="hljs-line"><span class="hljs-keyword">if</span> (a == <span class="hljs-number">1</span> &amp;&amp; a == <span class="hljs-number">2</span> &amp;&amp; a == <span class="hljs-number">3</span>) {
</div><div class="hljs-line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'OK'</span>);
</div><div class="hljs-line">}
</div></code></pre>



    <pre class="prettyprint hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>{
</div><div class="hljs-line">    get [<span class="hljs-built_in">Symbol</span>.toStringTag]() {
</div><div class="hljs-line">        <span class="hljs-keyword">return</span> <span class="hljs-string">'Person'</span>;
</div><div class="hljs-line">    }
</div><div class="hljs-line">}
</div><div class="hljs-line"><span class="hljs-keyword">let</span> p1 = <span class="hljs-keyword">new</span> Person;
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.prototype.toString.call(p1)); <span class="hljs-comment">//"[object Person]"</span>
</div></code></pre>

    <h4 id="generator生成器iterator迭代器及实战中的运用">Generator生成器/Iterator迭代器及实战中的运用</h4>

    <blockquote>
      <p>Iterator 是 ES6 引入的一种新的遍历机制</p>

      <ul>
        <li>
          <p>通过 Symbol.iterator 创建一个迭代器，指向当前数据结构的起始位置</p>
        </li>
        <li>
          <p>随后通过 next 方法进行向下迭代指向下一个位置， next 方法会返回当前位置的对象，对象包含了 value 和 done 两个属性， value 是当前属性的值， done 用于判断是否遍历结束</p>
        </li>
        <li>
          <p>当 done 为 true 时则遍历结束</p>
        </li>
      </ul>
    </blockquote>



    <pre class="prettyprint hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-comment">// 创造Iterator</span>
</div><div class="hljs-line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createIterator</span>(<span class="hljs-params">items</span>) </span>{
</div><div class="hljs-line">    <span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;
</div><div class="hljs-line">    <span class="hljs-keyword">return</span> {
</div><div class="hljs-line">        <span class="hljs-attr">next</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
</div><div class="hljs-line">            <span class="hljs-keyword">var</span> done = (i &gt;= items.length);
</div><div class="hljs-line">            <span class="hljs-keyword">var</span> value = !done ? items[i++] : <span class="hljs-literal">undefined</span>;
</div><div class="hljs-line">            <span class="hljs-keyword">return</span> {
</div><div class="hljs-line">                <span class="hljs-attr">done</span>: done,
</div><div class="hljs-line">                <span class="hljs-attr">value</span>: value
</div><div class="hljs-line">            };
</div><div class="hljs-line">        }
</div><div class="hljs-line">    };
</div><div class="hljs-line">}
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line"><span class="hljs-comment">// 迭代器特点</span>
</div><div class="hljs-line"><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>];
</div><div class="hljs-line"><span class="hljs-keyword">const</span> it = arr[<span class="hljs-built_in">Symbol</span>.iterator]();
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(it.next()); <span class="hljs-comment">//{value: 10, done: false}</span>
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(it.next()); <span class="hljs-comment">//{value: 20, done: false}</span>
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(it.next()); <span class="hljs-comment">//{value: 30, done: false}</span>
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(it.next()); <span class="hljs-comment">//{value: undefined, done: true}</span>
</div></code></pre>

    <blockquote>
      <p>Generator生成器对象是由一个 generator function 返回的,并且它符合可迭代协议</p>
    </blockquote>

    <pre class="prettyprint hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">gen</span>(<span class="hljs-params"></span>) </span>{
</div><div class="hljs-line">    <span class="hljs-keyword">yield</span> <span class="hljs-number">1</span>;
</div><div class="hljs-line">    <span class="hljs-keyword">yield</span> <span class="hljs-number">2</span>;
</div><div class="hljs-line">    <span class="hljs-keyword">yield</span> <span class="hljs-number">3</span>;
</div><div class="hljs-line">    <span class="hljs-keyword">return</span> <span class="hljs-number">4</span>;
</div><div class="hljs-line">}
</div><div class="hljs-line"><span class="hljs-keyword">let</span> g = gen();
</div><div class="hljs-line"><span class="hljs-comment">/* console.log(g.next()); //{value:1,done:false}</span>
</div><div class="hljs-line"><span class="hljs-comment">console.log(g.next()); //{value:2,done:false}</span>
</div><div class="hljs-line"><span class="hljs-comment">console.log(g.next()); //{value:3,done:false}</span>
</div><div class="hljs-line"><span class="hljs-comment">console.log(g.next()); //{value:4,done:true}</span>
</div><div class="hljs-line"><span class="hljs-comment">console.log(g.next()); //{value:undefined,done:true} */</span>
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line"><span class="hljs-comment">/* let item = g.next(),</span>
</div><div class="hljs-line"><span class="hljs-comment">    arr = [];</span>
</div><div class="hljs-line"><span class="hljs-comment">arr.push(item.value);</span>
</div><div class="hljs-line"><span class="hljs-comment">while (!item.done) {</span>
</div><div class="hljs-line"><span class="hljs-comment">    item = g.next();</span>
</div><div class="hljs-line"><span class="hljs-comment">    arr.push(item.value);</span>
</div><div class="hljs-line"><span class="hljs-comment">}</span>
</div><div class="hljs-line"><span class="hljs-comment">console.log(arr); */</span>
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line"><span class="hljs-keyword">let</span> arr = [];
</div><div class="hljs-line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> item <span class="hljs-keyword">of</span> g) {
</div><div class="hljs-line">    arr.push(item);
</div><div class="hljs-line">}
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(arr); <span class="hljs-comment">//[1,2,3]</span>
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(g.next()); <span class="hljs-comment">//{value:undefined,done:true}</span>
</div></code></pre>

    <pre class="prettyprint hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">gen</span>(<span class="hljs-params"></span>) </span>{
</div><div class="hljs-line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'OK'</span>);
</div><div class="hljs-line">    <span class="hljs-keyword">let</span> x = <span class="hljs-keyword">yield</span> <span class="hljs-number">1</span>;
</div><div class="hljs-line">    <span class="hljs-built_in">console</span>.log(x);
</div><div class="hljs-line">    <span class="hljs-keyword">yield</span> <span class="hljs-number">2</span>;
</div><div class="hljs-line">}
</div><div class="hljs-line"><span class="hljs-keyword">let</span> g = gen();
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(g.next());
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(g.next(<span class="hljs-number">10</span>));
</div></code></pre>

    <p><code>yield 委托*</code> <br>
      在Generator函数中，我们有时需要将多个迭代器的值合在一起，我们可以使用yield *的形式，将执行委托给另外一个Generator函数</p>



    <pre class="prettyprint hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">foo1</span>(<span class="hljs-params"></span>) </span>{
</div><div class="hljs-line">    <span class="hljs-keyword">yield</span> <span class="hljs-number">1</span>;
</div><div class="hljs-line">    <span class="hljs-keyword">yield</span> <span class="hljs-number">2</span>;
</div><div class="hljs-line">}
</div><div class="hljs-line"><span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">foo2</span>(<span class="hljs-params"></span>) </span>{
</div><div class="hljs-line">    <span class="hljs-keyword">yield</span> <span class="hljs-number">3</span>;
</div><div class="hljs-line">    <span class="hljs-keyword">yield</span> <span class="hljs-number">4</span>;
</div><div class="hljs-line">}
</div><div class="hljs-line"><span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">foo</span>(<span class="hljs-params"></span>) </span>{
</div><div class="hljs-line">    <span class="hljs-keyword">yield</span>* foo1();
</div><div class="hljs-line">    <span class="hljs-keyword">yield</span>* foo2();
</div><div class="hljs-line">    <span class="hljs-keyword">yield</span> <span class="hljs-number">5</span>;
</div><div class="hljs-line">}
</div><div class="hljs-line"><span class="hljs-keyword">const</span> result = foo();
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(result.next()); <span class="hljs-comment">// { value: 1, done: false }</span>
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(result.next()); <span class="hljs-comment">// { value: 2, done: false }</span>
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(result.next()); <span class="hljs-comment">// { value: 3, done: false }</span>
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(result.next()); <span class="hljs-comment">// { value: 4, done: false }</span>
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(result.next()); <span class="hljs-comment">// { value: 5, done: false }</span>
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(result.next()); <span class="hljs-comment">// { value: undefined, done: true }</span>
</div></code></pre>



    <h4 id="手撕asyncawait源码">手撕async/await源码</h4>



    <pre class="prettyprint hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-comment">// 模拟API请求接口</span>
</div><div class="hljs-line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">API</span>(<span class="hljs-params">num</span>) </span>{
</div><div class="hljs-line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {
</div><div class="hljs-line">        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
</div><div class="hljs-line">            resolve(num);
</div><div class="hljs-line">        }, <span class="hljs-number">1000</span>);
</div><div class="hljs-line">    });
</div><div class="hljs-line">}
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line"><span class="hljs-comment">//自动执行器，如果一个Generator函数没有执行完，则递归调用</span>
</div><div class="hljs-line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">asyncFun</span>(<span class="hljs-params">generator</span>) </span>{
</div><div class="hljs-line">    <span class="hljs-keyword">let</span> iterator = generator();
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">next</span>(<span class="hljs-params">data</span>) </span>{
</div><div class="hljs-line">        <span class="hljs-keyword">let</span> result = iterator.next(data);
</div><div class="hljs-line">        <span class="hljs-keyword">if</span> (result.done) <span class="hljs-keyword">return</span> result.value;
</div><div class="hljs-line">        result.value.then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{
</div><div class="hljs-line">            next(data);
</div><div class="hljs-line">        });
</div><div class="hljs-line">    }
</div><div class="hljs-line">    next();
</div><div class="hljs-line">}
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line">asyncFun(<span class="hljs-function"><span class="hljs-keyword">function</span>* (<span class="hljs-params"></span>) </span>{
</div><div class="hljs-line">    <span class="hljs-keyword">let</span> res1 = <span class="hljs-keyword">yield</span> API(<span class="hljs-number">10</span>);
</div><div class="hljs-line">    <span class="hljs-built_in">console</span>.log(res1);
</div><div class="hljs-line">    <span class="hljs-keyword">let</span> res2 = <span class="hljs-keyword">yield</span> API(res1 + <span class="hljs-number">10</span>);
</div><div class="hljs-line">    <span class="hljs-built_in">console</span>.log(res2);
</div><div class="hljs-line">});
</div></code></pre>

    <h4 id="setmap运用">Set/Map运用</h4>

    <blockquote>
      <p>ES6 提供了新的数据结构 Set。它类似于数组，但是成员的值都是唯一的，没有重复的值。</p>

      <ul>
        <li>
          <p>基础语法</p>
        </li>
        <li>
          <p>Set 内部判断两个值是否不同，使用的算法叫做“Same-value-zero equality [iˈkwɒləti] ”，它类似于 <code>===</code>，主要的区别是它认为NaN和NaN相等的
          </p>
        </li>
      </ul>

      <p>WeakSet 结构与 Set 类似，也是不重复的值的集合，但是，它与 Set 有两个区别：</p>

      <ul>
        <li>
          <p>首先，WeakSet 的成员只能是对象，而不能是其他类型的值</p>
        </li>
        <li>
          <p>其次，WeakSet 中的对象都是弱引用，即垃圾回收机制不考虑 WeakSet 对该对象的引用，也就是说，如果其他对象都不再引用该对象，那么垃圾回收机制会自动回收该对象所占用的内存，不考虑该对象还存在于
            WeakSet 之中</p>
        </li>
      </ul>
    </blockquote>

    <pre class="prettyprint hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"> <span class="hljs-keyword">let</span> a = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);
</div><div class="hljs-line"> <span class="hljs-keyword">let</span> b = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]);
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line"> <span class="hljs-comment">// 并集</span>
</div><div class="hljs-line"> <span class="hljs-keyword">let</span> union = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([...a, ...b]);
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line"> <span class="hljs-comment">// 交集</span>
</div><div class="hljs-line"> <span class="hljs-keyword">let</span> intersect = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([...a].filter(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> b.has(x)));
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line"> <span class="hljs-comment">// 差集</span>
</div><div class="hljs-line"> <span class="hljs-keyword">let</span> difference = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([...a].filter(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> !b.has(x)));
</div></code></pre>

    <blockquote>
      <p>ES6 提供了 Map 数据结构，它类似于对象，也是键值对的集合，但是“键”的范围不限于字符串，各种类型的值（包括对象）都可以当作键</p>
    </blockquote>

  </div>
</body>

</html>