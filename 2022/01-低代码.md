# 低代码

## JSON Schema

JSON (JavaScript Object Notation) 缩写，JSON 是一种数据格式，具有简洁、可读性高、支持广泛的特点JSON。通过JSON 我们可以灵活地来表示任意复杂的数据结构。

JSON Schema 主要用于描述 JSON 数据。针对不同的应用场景，我们想约定JSON的数据所包含的字段、字段值得类型甚至依赖关系，那我们就需要有个规范来描述这些约束的关系。而这也是JSON Schema 所存在的理由。

JSON Schema本身是用JSON编写的, 换句话说他本身就是JSON文件！

JSON Schema 本质上就是结构化json定义

## 表单数据校验

validator工具库：

1、ajv（这个经典的开源工具，它是一个非常流行的JSON Schema验证工具，而且性能号称最佳，最快的JSON Schema验证器）
2、async-validator（异步校验，element、iView 使用的）
3、validator.js（字符串校验库）
4、joi（基于JavaScript对象的对象模式描述语言和验证器）
5、Superstruct（用简单和可组合的方式在JavaScript和TypeScript中校验数据）

## 低代码 low-code

1、h5-Dooring （react、Ant-design）https://github.com/MrXujiang/h5-Dooring
2、百度-amis （React）https://gitee.com/baidu/amis https://baidu.gitee.io/amis/zh-CN/docs/index https://aisuda.github.io/amis-editor-demo/#/hello-world
3、vue-layout （vue）https://github.com/jaweii/Vue-Layout
4、阿里巴巴-formily （React、Ant Design） https://github.com/alibaba/formily
5、阿里巴巴-alist
6、luban(鲁班 H5) （Ant Design、Vue）https://github.com/ly525/luban-h5
7、Sparrow（基于vue、element-ui）https://github.com/sparrow-js/sparrow
8、wti-form（低代码表单组件，基于 Element-ui 二次开发）https://github.com/qq20004604/wti-form
9、JeecgBoot（Ant Design、Vue）https://github.com/jeecgboot/jeecg-boot
9、diboot（Ant Design、Vue）https://gitee.com/dibo_software/diboot
10、Variant Form（Vue Element） https://www.vform666.com/
11、GrapesJS —— craft.js GrapesJS 是一款国外的页面编辑器框架

## 关于拖拽

1、vuedraggable（它是基于Sortable.js实现的 vue 拖拽插件）https://github.com/SortableJS/Vue.Draggable
2、vue-draggable-resizable（vue、控件可以自定义进行大小拖拽）https://github.com/mauricius/vue-draggable-resizable
3、HTML5原生拖拽/拖放 Drag & Drop （也有很多低代码库是自己使用的HTML5的原生api）
4、easy-drag（原生js）https://github.com/junqiuzhang/easy-drag
5、carddragger（vue）https://github.com/dwanda/dragComponent
6、react-dragable 和 react-resiable 两个库来实现拖拽和缩放 https://github.com/react-grid-layout/react-draggable https://github.com/react-grid-layout/react-resizable
7、rc-drag（react）https://github.com/MrXujiang/rc-drag
8、@shopify/draggable （原生js start多，用户多）https://github.com/Shopify/draggable
9、react-dnd（react）https://react-dnd.github.io/react-dnd/

## 画布模块

一般画布的比例设置大多以16:9或者4:3两种比例居多

## 收集信息

在讨论各个低代码方案前，首先要明确「低代码」究竟是什么？

个人见解：低代码就是 减少代码量、复用重复代码、快速开发出界面、配置化、可视化编辑... 以上都可以算是低代码，只能区分出低的程度，也基本是低代码的一个进化吧。

目前市面上主要流行的就是：可视化编辑。

说到可视化编辑，必备的就是需要一个编辑器、需用通过编辑器生成代码块，或者生成配置文件配合组件等

「所有」低代码平台必然只能采用「声明式」代码，这也是为什么所有低代码平台都会有内置的「DSL」。

DSL 即「Domain Specific Language」，中文一般译为「领域特定语言」，一种为特定领域设计的，具有受限表达性的编程语言。https://en.wikipedia.org/wiki/Domain-specific_language

非常适合使用 DSL 的场景：

* 重复性工作多
* 沟通成本大，参加角色多
* 业务非常清楚细节

前面说到前端界面低代码是比较容易，但交互及逻辑处理却很难低代码话，目前常见有三种方案：

* 使用图形化编程 https://scratch.mit.edu/
* 固化交互行为
* 使用 JavaScript

除了弹框之外还有发起请求、打开链接、刷新其它组件等，使用固化交互行为有下面两个优点：

* 可以可视化编辑
* 整合度高，比如弹框里可以继续使用配置，通过嵌套实现复杂的交互逻辑

但这个方案最大的缺点是灵活性受限，只能使用组件内置的行为。

为什么大家几乎全都使用 JSON？我觉得有两方面原因：

* 低代码平台编辑器几乎都是基于 Web 实现，JavaScript 可以方便操作 JSON。
* JSON 可以支持双向编辑，它的读取和写入是一一对应的。

以下是几个比较典型的低代码可视化平台需求:

    出码能力(即源码下载功能)
    组件交互(即组件支持业务中常用的链接跳转，弹窗交互，自定义事件等)
    数据源管理(即用户创建的不同页面拥有共享数据的能力，不同组件之间也有共享数据的能力)
    组件商店(即用户可以自主生产组件，定义组件，接入组件数据的能力)
    布局能力(即用户可以选择不同的布局方案来设计页面)
    常用功能集成(页面截图，微信分享，debug能力)

## 问卷调查实现方案

10、Variant Form（Vue Element） https://www.vform666.com/

一、表单生成器
  1、左侧 物料区

    组件库
      先封装问卷常用的组件，Input、Select、Radio、Checkbox 等等
    模版库
      先定制常用问卷模版
      ...其他组件库可以后续扩展
    技术方案：
      vue（框架） + Antd（UI） + vuedraggable（拖拽）
      简单思路：可以使用 vue 的 `<component :is="componentId"></component>` 动态组件的方式，二次封装 Antd 组件，结合拖拽动画实现。
      https://v3.cn.vuejs.org/api/built-in-components.html#component

  2、中间 编辑区

    头部工具栏
      撤销undo、恢复redo 功能。保存每一步操作，可用类数组结构或者 栈的数据结构
      设备响应式 PC、Pad、H5。设置不同的宽度，加上设备外形背景图片
      组件层次结构树（暂时可不做）遍历节点，用树形 Tree 组件实现
      清空
      预览 获取配置的 JSON， 用 render 组件渲染出页面
      导入JSON （暂时可不做）导入符合 数据格式的 JSON 数据。涉及代码编辑器，可采用 ACE 开源库
      导出JSON 获取配置的 JSON，涉及代码编辑器，可采用 ACE 开源库
      导出代码 生成 html 文件 或者 .vue 文件，写好模版，采用字符串拼接的方式。最后加入配置数据， 涉及代码编辑器，可采用 ACE 开源库
      生成SFC （暂时可不做）涉及代码编辑器，可采用 ACE 开源库
    编辑面板
      可以使用 vue 的 `<component :is="componentId"></component>` 动态组件的方式，和 拖拽组件

  3、右侧 配置区

    组件设置
      单个组件的一些属性值的设置，可设置一些常用的可配置的属性，form表单 + 可以使用 vue 的 `<component :is="componentId"></component>` 动态组件的方式
    表单设置
      表单的属性设置，也是开放常用，经常变动的属性，技术同上。
二、生成代码

    可视化这块主要还是 为了获取配置文件，也就是 JSON 数据双向绑定，拿到 配置好的JSON， 在用写好的模版去加载，内置渲染组件。
    实现方式就是 写一个正常的模版文件，可以正常渲染，用字符串拼接参数的方式修改 JSON 数据。

三、根据收集的数据进行可视化分析

    表单最后可配置提交的接口，后端收集数据，后续返回给前端的 可视化分析页面，可视化分析页面也可以配置参数之类的，类似 t-query 的可视化页面

四、前置积累

整个可视化搭建系统分为三部分，分别是配置页(setting),视图页(view) 和 json schema。配置页生成 json schema，视图页消费 json schema，技术栈 antd，至于其他的比如拖拽，参考线，状态管理，插件机制

    1、已有渲染组件，和 JSON Schema，基本满足需求，不用重复开发 https://juejin.cn/post/7021833269821833229
    2、可视化分析页面 也有积累，可以复用之前的代码
    3、有专门了解过 撤销/恢复的操作逻辑
    4、参与过类似的项目，如活动可视化配置项目
